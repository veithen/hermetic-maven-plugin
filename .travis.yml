dist: trusty
language: java
jdk:
  - openjdk8
  - openjdk9
  - openjdk10
  - openjdk11
before_install:
  - if [ -e $JAVA_HOME/lib/security/cacerts ]; then ln -sf /etc/ssl/certs/java/cacerts $JAVA_HOME/lib/security/cacerts; fi
install: true
script: mvn -B -e -s .travis-settings.xml -Prelease -Dgpg.skip=true verify
before_cache: "find $HOME/.m2 -name '*-SNAPSHOT' -a -type d -print0 | xargs -0 rm -rf"
jobs:
  include:
    - if: repo = "veithen/hermetic-maven-plugin" AND branch = master AND type = push
      stage: deploy
      script: mvn -B -e -s .travis-settings.xml -Prelease -Dgpg.skip=true -DskipTests=true deploy
      env:
        - secure: "nrk/nyriv/2rgWeuw9d0y3LhybrB00YC60nflF2mBHTFvzvkb45bJ9zYqhd4Q1Uv8a6poEt33bbwsonCAG77RfKQ77wpAQ2XjiHo4EvsUOd9VYUnqBmKo8V/7XQBVtALu7ZqciVUSKzaqNph4x8E673+P/md31SVE/cimLd0L3OM5Z9/GioIsbX3WIvzjXeclc3WHuRB01jI7eXY+HXnRoEGtFoXCE1m78BJRCCszxpnz+lONM99E9A2WjnIz6rMTg7cDBhnYI1QVxLpsK/6tZ8jMPAodhlcDwvHR7cfmK4r2/EklJeSUhOKv7YYdYdSa9hT3BLYoNrmnrTe9mnwOZwOBL2TfQe5dlcbGIStbG7qB7G0gR0yz2TWYniJqK0iGC+tHk8+1BWjUEVMRbTzgcK7LkwUBe1Aq1WIJeON0TkGWDIAJs7zK6j8pOz+fXDHlKYji4IXvdIOiKWo8LQo3GpW/4qPbsJOBIIcMFRDQscaK7jegQt6RVDfHmKgQeCl/zLVP+ztqtDpoKC914uPlrRx7HcMFrjiwxeMOiusso+zDU0jkrvrNivbwiSKYpNlxX43j4aV0YeTtnki1/T56Frc6BwenZElqYH5ixSn07+LlkJiosqGfx5o7BBoOkdwz8smK671IrJHIyKGAqHF33n9fIlF2EMDsIOl6SHHdmo="
cache:
  directories:
    - $HOME/.m2
